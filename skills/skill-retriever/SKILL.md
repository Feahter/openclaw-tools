---
name: skill-retriever
description: 技能语义检索器 - 基于LLM语义理解智能检索和推荐相关Skills。无需向量数据库，利用大模型本身的语义理解能力匹配查询与技能。用于技能发现、能力匹配、工作流优化。适用场景：不确定用什么skill时、探索可用能力、复杂任务分解。
---

# Skill Retriever (技能检索器) v2.0 - LLM语义版

**核心洞察**：大语言模型本身就具备强大的语义理解能力，无需额外的向量数据库。

## 核心原理

### 为什么不使用向量搜索？

传统方案：
```
查询 → Embedding模型 → 向量数据库 → 相似度计算 → 结果
```

本方案：
```
查询 + 所有技能描述 → LLM语义理解 → 直接判断相关性 → 结果
```

**优势**：
1. **真正的语义理解** - 理解同义词、隐含意图、复杂表达
2. **无需外部依赖** - 不需要ChromaDB、embedding模型
3. **即时响应** - 无需预计算embedding
4. **动态适应** - 可以根据对话上下文调整判断

### LLM语义匹配示例

**用户查询**: "我想让文字更有画面感"

**传统关键词匹配**:
- 匹配"文字" → 找到writing相关技能
- 匹配"画面" → 找到image相关技能（错误！）
- 匹配"感" → 无意义

**LLM语义理解**:
- 理解"画面感" = 具象描写、感官细节、生动表达
- 正确匹配: detail-painter, ladder-of-abstraction (具象化方向)
- 排除: image处理技能

## 使用方法

### 方式1: 直接询问（推荐）
```
我不确定用什么技能，我想把这段文字改得更生动形象
```

我会：
1. 理解你的需求（具象化描写）
2. 回忆所有可用技能
3. 推荐最匹配的: detail-painter 或 ladder-of-abstraction
4. 解释为什么推荐这个

### 方式2: 显式调用
```
用skill-retriever帮我找能处理PDF的技能
```

### 方式3: 探索式询问
```
我有哪些数据分析相关的技能？
列举一下所有写作相关的技能
```

## 检索策略

### 策略1: 直接语义匹配（技能数 < 100）
当技能数量较少时，直接加载所有技能元数据，进行语义比较。

```
系统指令: 以下是所有可用技能...
用户查询: 我想处理PDF文件
LLM推理: 
  - pdf技能描述匹配100%
  - pdf-text-extractor匹配90%
  - mineru匹配80%（支持PDF解析）
  - 其他技能不匹配
输出: 推荐前3个
```

### 策略2: 分层过滤（技能数 > 100）
当技能数量很多时，先按类别过滤，再语义匹配。

```
步骤1: 理解查询所属类别
  "处理PDF" → 类别: document/media

步骤2: 只加载该类别的技能
  pdf, pdf-text-extractor, docx, mineru, ...

步骤3: 在这些技能中语义匹配
```

### 策略3: 渐进式披露
```
Level 1: 始终加载 - 技能名称列表（极简）
Level 2: 按需加载 - 具体技能的完整描述
Level 3: 运行时 - 动态加载相关技能详细说明
```

## 工作流程

### 当用户查询需要技能时：

1. **理解意图**
   - 分析用户真实需求
   - 识别任务类型（写作/分析/开发/媒体...）

2. **检索匹配**
   - 加载相关技能元数据（或全部）
   - 语义比较：查询 vs 技能描述
   - 排序：按语义相关度

3. **推荐与解释**
   - 推荐Top-K技能
   - 解释推荐理由
   - 给出使用示例

4. **动态加载**
   - 用户确认后，加载选定技能的完整内容
   - 执行任务

## 与向量检索的对比

| 特性 | 向量检索方案 | LLM语义方案 (本方案) |
|------|-------------|---------------------|
| **准确率** | 高（基于embedding相似度）| 更高（基于深层语义理解）|
| **灵活性** | 固定模型，难以调整 | 可根据上下文动态调整 |
| **外部依赖** | 需要ChromaDB/Pinecone | 完全内建，零依赖 |
| **冷启动** | 需要预计算embedding | 即时可用 |
| **成本** | embedding API费用 | 已有LLM调用，无额外成本 |
| **技能数限制** | 无限制 | 受限于上下文长度 |

## 实际使用示例

### 示例1: 模糊查询
**用户**: "我想让这段文字读起来更带感"

**我的理解**:
- "带感" = 生动、有感染力、能引起共鸣
- 可能的技能：
  - detail-painter (感官细节)
  - folk-marketing (接地气表达)
  - one-sentence-novel (金句提炼)

**推荐**:
> 根据你的描述，推荐以下技能：
> 1. **detail-painter** - 通过细腻感官描写让文字更生动
> 2. **folk-marketing** - 用俚语和俏皮话增加感染力
>
> 你更倾向于哪种风格？

### 示例2: 复杂需求
**用户**: "我要做个数据分析报告，需要先把数据从Excel里读出来，然后画图，最后生成PDF"

**我的理解**:
- 多步骤任务
- 需要技能组合：xlsx → data visualization → pdf

**推荐**:
> 这是一个多步骤任务，建议按顺序使用：
> 1. **xlsx** - 读取和处理Excel数据
> 2. **canvas-design** 或编程绘图 - 生成图表
> 3. **pdf** - 生成最终PDF报告
>
> 需要我帮你按这个流程执行吗？

### 示例3: 意图澄清
**用户**: "帮我处理这个文件"

**我的理解**:
- "文件"太模糊，可能是pdf/docx/xlsx/image...
- 需要澄清

**回应**:
> "处理文件"有点宽泛，你具体想做什么？
> - 提取文字内容？
> - 转换格式？
> - 编辑修改？
> - 分析数据？
>
> 或者你可以告诉我文件类型（PDF/Word/Excel等）

## 运行规则

1. **主动理解** - 不依赖关键词匹配，直接理解语义
2. **动态推荐** - 根据对话上下文调整推荐
3. **解释理由** - 说明为什么推荐某个技能
4. **澄清模糊** - 需求不明确时主动询问
5. **组合推荐** - 复杂任务推荐技能组合

## 进阶功能

### 个性化记忆
记住用户的偏好：
- "上次你处理PDF时用了mineru，这次继续用吗？"
- "你对学术写作类技能用得比较多..."

### 技能组合推荐
复杂任务自动识别所需技能链：
- 数据报告: xlsx → analysis → visualization → pdf
- 内容创作: brainstorm → writing → design → export

### 使用示例生成
不仅推荐技能，还生成具体使用示例：
> 推荐：**ladder-of-abstraction**
> 用法示例："用抽象之梯把'他吃得很香'改写成具象描写"

## 总结

**核心观点**：与其依赖外部向量数据库做"伪语义"匹配，不如直接利用大语言模型本身强大的语义理解能力。

**适用场景**：
- ✅ 技能数量 < 200（当前上下文可承载）
- ✅ 需要真正理解用户意图
- ✅ 需要解释推荐理由
- ✅ 需要灵活调整匹配逻辑

**不适用场景**：
- ❌ 技能数量 > 1000（超出上下文限制）
- ❌ 需要毫秒级响应（LLM推理需要时间）
